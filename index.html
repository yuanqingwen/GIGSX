<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIGSX - Platform Komik Premium</title>
    <style>
        :root {
            --primary: #8B5CF6;
            --secondary: #EC4899;
            --accent: #D946EF;
            --bg: linear-gradient(135deg, #1e1b4b 0%, #3b1f6b 50%, #a855f7 100%);
            --card: rgba(255,255,255,0.12);
            --card-hover: rgba(255,255,255,0.22);
            --text: #f8fafc;
            --text-muted: rgba(255,255,255,0.7);
            --border: rgba(255,255,255,0.18);
            --glass: rgba(255,255,255,0.08);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg);
            color: var(--text);
            overflow-x: hidden;
        }

        /* LOGO */
        .logo {
            font-size: 2.8rem;
            font-weight: 900;
            background: linear-gradient(45deg, var(--primary), var(--secondary), var(--accent));
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: logoGlow 3s ease-in-out infinite alternate;
            text-shadow: 0 0 40px rgba(139, 92, 246, 0.6);
        }

        @keyframes logoGlow {
            0% { filter: hue-rotate(0deg) drop-shadow(0 0 20px rgba(139,92,246,0.5)); }
            100% { filter: hue-rotate(60deg) drop-shadow(0 0 40px rgba(236,72,153,0.7)); }
        }

        /* NAVBAR */
        .navbar {
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(25px);
            padding: 1rem 5%;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--border);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2.5rem;
        }

        .nav-links a {
            color: var(--text);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.4s;
            position: relative;
            padding: 0.5rem 0;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            transition: width 0.4s;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .nav-links a:hover {
            color: var(--secondary);
            text-shadow: 0 0 15px var(--secondary);
        }

        .admin-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem 2.5rem;
            border: none;
            border-radius: 50px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s;
            box-shadow: 0 12px 35px rgba(139, 92, 246, 0.5);
            position: relative;
            overflow: hidden;
        }

        .admin-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .admin-btn:hover::before {
            left: 100%;
        }

        .admin-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 20px 45px rgba(139, 92, 246, 0.7);
        }

        /* MAIN CONTENT */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 140px 5% 8rem;
        }

        .hero {
            text-align: center;
            margin-bottom: 5rem;
        }

        .hero h1 {
            font-size: 5rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% 200%;
            animation: heroGlow 4s ease-in-out infinite;
        }

        @keyframes heroGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .hero p {
            font-size: 1.3rem;
            color: var(--text-muted);
        }

        /* COMIC GRID */
        .comic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 2.5rem;
            margin-bottom: 5rem;
        }

        .comic-card {
            background: var(--card);
            border-radius: 25px;
            overflow: hidden;
            backdrop-filter: blur(15px);
            border: 1px solid var(--border);
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            position: relative;
        }

        .comic-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(139,92,246,0.1), rgba(236,72,153,0.1));
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 1;
        }

        .comic-card:hover::before {
            opacity: 1;
        }

        .comic-card:hover {
            transform: translateY(-15px) scale(1.02);
            background: var(--card-hover);
            box-shadow: 0 35px 70px rgba(0,0,0,0.4);
        }

        .comic-cover {
            width: 100%;
            height: 280px; /* Increased height for comic covers */
            position: relative;
            overflow: hidden;
        }

        .comic-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cover-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: white;
            text-shadow: 0 0 15px rgba(0,0,0,0.5);
        }

        .cover-overlay {
            position: absolute;
            bottom: 15px;
            right: 15px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .comic-info {
            padding: 2rem;
            position: relative;
            z-index: 2;
        }

        .comic-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 0.8rem;
            line-height: 1.3;
        }

        .comic-description {
            color: var(--text-muted);
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .comic-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.95rem;
            color: var(--text-muted);
        }

        /* COMIC READER PAGE */
        .comic-reader-page {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 140px 5% 5rem;
        }

        .reader-container {
            background: var(--glass);
            border-radius: 25px;
            padding: 3rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border);
            backdrop-filter: blur(20px);
        }

        .comic-display {
            width: 100%;
            min-height: 500px;
            border-radius: 20px;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            text-align: center;
            padding: 2rem;
        }

        .comic-details h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .back-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 2rem;
            transition: all 0.3s;
        }

        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(139, 92, 246, 0.4);
        }

        /* IKLAN - POSISI TERBAWAH */
        .ads-container {
            background: var(--card);
            border-radius: 20px;
            padding: 3rem;
            margin: 6rem auto 3rem; /* Pindahkan iklan ke bawah */
            text-align: center;
            border: 1px solid var(--border);
            max-width: 1400px;
            backdrop-filter: blur(15px);
        }

        /* MODALS */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 3000;
            backdrop-filter: blur(15px);
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(30,27,75,0.98), rgba(59,31,107,0.98));
            margin: 5% auto;
            padding: 3.5rem;
            border-radius: 30px;
            max-width: 550px;
            width: 92%;
            border: 1px solid var(--border);
            backdrop-filter: blur(25px);
            box-shadow: 0 40px 100px rgba(0,0,0,0.5);
        }

        /* ADMIN PANEL */
        .admin-panel {
            display: none;
            max-width: 1400px;
            margin: 2rem auto;
            padding: 3rem;
        }

        .admin-nav {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .admin-nav button {
            padding: 1.2rem 2.5rem;
            background: var(--glass);
            color: var(--text);
            border: 1px solid var(--border);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.4s;
            font-weight: 600;
        }

        .admin-nav button.active,
        .admin-nav button:hover {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(139, 92, 246, 0.4);
        }

        .admin-section {
            display: none;
            background: var(--card);
            padding: 3rem;
            border-radius: 25px;
            border: 1px solid var(--border);
        }

        .admin-section.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2.5rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: rgba(255,255,255,0.12);
            padding: 2.5rem;
            border-radius: 20px;
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .stat-number {
            font-size: 3.5rem;
            font-weight: 900;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .comic-list {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .comic-item {
            background: rgba(255,255,255,0.08);
            padding: 2rem;
            border-radius: 18px;
            border: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .comic-item:hover {
            background: rgba(255,255,255,0.15);
            transform: translateX(10px);
        }

        /* FORMS */
        .form-group {
            margin-bottom: 2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.8rem;
            font-weight: 700;
            color: var(--secondary);
            font-size: 1.1rem;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 1.2rem;
            border: 2px solid var(--border);
            border-radius: 15px;
            background: rgba(255,255,255,0.12);
            color: var(--text);
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 25px rgba(236, 72, 153, 0.4);
            background: rgba(255,255,255,0.18);
        }

        .btn-primary {
            width: 100%;
            padding: 1.5rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.5);
        }

        /* LOADING */
        .loading {
            display: none;
            text-align: center;
            padding: 3rem;
        }

        .spinner {
            border: 5px solid var(--border);
            border-top: 5px solid var(--secondary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 2rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .hero h1 { font-size: 3rem; }
            .comic-grid { grid-template-columns: 1fr; }
            .reader-container { padding: 2rem 1rem; }
        }

        /* EMPTY STATE */
        .empty-state {
            text-align: center;
            padding: 6rem 2rem;
            color: var(--text-muted);
        }

        .empty-state h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <!-- NAVBAR -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">DIGSX</div>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#comics">Komik</a></li>
                <li><a href="#about">Tentang</a></li>
            </ul>
            <button class="admin-btn" onclick="openAdminLogin()">üîê Admin Panel</button>
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <div class="main-container" id="mainContent">
        <!-- HERO -->
        <div class="hero">
            <h1>DIGSX</h1>
            <p>Platform komik premium dengan desain ungu-pink tercanggih ‚ú®</p>
        </div>

        <!-- COMIC GRID -->
        <div id="comicGrid" class="comic-grid"></div>
        
        <div id="noComics" class="empty-state" style="display: none;">
            <h2>üìö Belum ada komik</h2>
            <p>Admin belum mengupload konten. Silakan cek lagi nanti!</p>
        </div>
    </div>

    <!-- COMIC READER PAGE -->
    <div id="comicReaderPage" class="comic-reader-page">
        <button class="back-btn" onclick="showMainPage()">‚Üê Kembali ke Home</button>
        <div class="reader-container">
            <div class="comic-display" id="comicDisplay">
                <!-- Isi komik (simulasi) akan tampil di sini -->
            </div>
            <div class="comic-details">
                <h1 id="readerTitle"></h1>
                <p id="readerDesc"></p>
                <div id="readerMeta" class="comic-meta"></div>
            </div>
        </div>
        <!-- IKLAN di bawah halaman reader -->
        <div class="ads-container">
            <div id="ad-container-reader">
                <script async="async" data-cfasync="false" src="//pl28189289.effectivegatecpm.com/bc4db932080e817e5266a26132d9f242/invoke.js"></script>
                <div id="container-bc4db932080e817e5266a26132d9f242"></div>
            </div>
        </div>
    </div>

    <!-- IKLAN - POSISI TERBAWAH UNTUK HALAMAN UTAMA -->
    <div id="mainPageAds" class="ads-container">
        <div id="ad-container-main">
            <script async="async" data-cfasync="false" src="//pl28189289.effectivegatecpm.com/bc4db932080e817e5266a26132d9f242/invoke.js"></script>
            <div id="container-bc4db932080e817e5266a26132d9f242"></div>
        </div>
    </div>

    <!-- LOGIN MODAL -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('loginModal')">&times;</span>
            <h2>üîê Admin Login</h2>
            <form onsubmit="loginAdmin(event)">
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="adminEmail" required>
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="adminPass" required>
                </div>
                <button type="submit" class="btn-primary">üöÄ Masuk Admin</button>
            </form>
        </div>
    </div>

    <!-- ADMIN PANEL -->
    <div id="adminPanel" class="admin-panel">
        <h2>üéõÔ∏è DIGSX Admin Panel Premium</h2>
        <div class="admin-nav">
            <button onclick="showAdminSection('dashboard')" class="active">üìä Dashboard</button>
            <button onclick="showAdminSection('uploadComic')">üì§ Upload Komik</button>
            <button onclick="showAdminSection('manageComics')">üìö Kelola Komik</button>
            <button onclick="logoutAdmin()">üö™ Logout</button>
        </div>

        <!-- DASHBOARD -->
        <div id="dashboard" class="admin-section active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalReads">0</div>
                    <div>Total Dibaca</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalComics">0</div>
                    <div>Total Komik</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalVisitors">0</div>
                    <div>Total Pengunjung</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="adImpressions">0</div>
                    <div>Tayangan Iklan</div>
                </div>
            </div>
        </div>

        <!-- UPLOAD KOMIK -->
        <div id="uploadComic" class="admin-section">
            <h3>üì§ Upload Komik Baru</h3>
            <form id="uploadForm" onsubmit="uploadComic(event)">
                <div class="form-group">
                    <label>Judul Komik:</label>
                    <input type="text" id="comicTitle" required>
                </div>
                <div class="form-group">
                    <label>Cerita Komik:</label>
                    <textarea id="comicStory" rows="8" required></textarea>
                </div>
                <div class="form-group">
                    <label>Sampul Komik (Gambar):</label>
                    <input type="file" id="comicCoverFile" accept="image/*" required>
                </div>
                <button type="submit" class="btn-primary">üöÄ Upload Komik Sekarang</button>
            </form>
            <div id="uploadProgress" class="loading">
                <div class="spinner"></div>
                <p>‚è≥ Sedang memproses komik... Sampul komik otomatis di-upload (3-4 detik)</p>
            </div>
        </div>

        <!-- MANAGE KOMIK -->
        <div id="manageComics" class="admin-section">
            <h3>üìö Daftar Komik</h3>
            <div id="adminComicList" class="comic-list"></div>
        </div>
    </div>

    <script>
        // DATABASE LOCALSTORAGE
        const DB = {
            init() {
                if (!localStorage.getItem('digsx_comics')) {
                    localStorage.setItem('digsx_comics', JSON.stringify([]));
                }
                if (!localStorage.getItem('digsx_stats')) {
                    localStorage.setItem('digsx_stats', JSON.stringify({
                        totalReads: 0,
                        totalComics: 0,
                        totalVisitors: 0,
                        adImpressions: 0
                    }));
                }
                if (!localStorage.getItem('digsx_admin')) {
                    localStorage.setItem('digsx_admin', 'false');
                }
            },
            getComics() {
                return JSON.parse(localStorage.getItem('digsx_comics') || '[]');
            },
            saveComics(comics) {
                localStorage.setItem('digsx_comics', JSON.stringify(comics));
            },
            getStats() {
                return JSON.parse(localStorage.getItem('digsx_stats') || '{}');
            },
            updateStats(updates) {
                const stats = this.getStats();
                Object.assign(stats, updates);
                localStorage.setItem('digsx_stats', JSON.stringify(stats));
            },
            loginAdmin() {
                localStorage.setItem('digsx_admin', 'true');
            },
            logoutAdmin() {
                localStorage.setItem('digsx_admin', 'false');
            }
        };

        // Simpan referensi Blob/URL untuk gambar cover
        let comicCoverCache = new Map();

        // INIT
        DB.init();
        loadComics();
        updateStatsDisplay();
        trackVisitor();

        function trackVisitor() {
            const stats = DB.getStats();
            stats.totalVisitors = (stats.totalVisitors || 0) + 1;
            DB.updateStats(stats);
            updateStatsDisplay();
        }

        // LOAD KOMIK DENGAN SAMPUL
        function loadComics() {
            const comics = DB.getComics();
            const grid = document.getElementById('comicGrid');
            const noComics = document.getElementById('noComics');
            const mainPageAds = document.getElementById('mainPageAds');

            if (comics.length === 0) {
                grid.style.display = 'none';
                noComics.style.display = 'block';
                mainPageAds.style.display = 'block'; // Iklan tetap tampil meski tidak ada komik
                return;
            }

            grid.style.display = 'grid';
            noComics.style.display = 'none';
            mainPageAds.style.display = 'block'; // Pastikan iklan utama tampil
            grid.innerHTML = '';

            comics.forEach((comic, index) => {
                const card = document.createElement('div');
                card.className = 'comic-card';
                card.onclick = () => readComicFullPage(comic, index);
                
                const coverUrl = comicCoverCache.get(comic.id) || (comic.coverDataUrl ? comic.coverDataUrl : '');
                 
                card.innerHTML = `
                    <div class="comic-cover">
                        ${coverUrl ? 
                            `<img src="${coverUrl}" alt="${comic.title} Cover">` : 
                            `<div class="cover-placeholder">${comic.title.substring(0,1).toUpperCase()}</div>`
                        }
                        <div class="cover-overlay">üìö ${comic.reads || 0} dibaca</div>
                    </div>
                    <div class="comic-info">
                        <div class="comic-title">${comic.title}</div>
                        <div class="comic-description">${comic.description.substring(0, 100)}${comic.description.length > 100 ? '...' : ''}</div>
                        <div class="comic-meta">
                            <span>üëÅÔ∏è ${comic.reads || 0} dibaca</span>
                            <span>${new Date(comic.uploaded).toLocaleDateString('id-ID')}</span>
                        </div>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        // FULL PAGE COMIC READER
        function readComicFullPage(comic, index) {
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('mainPageAds').style.display = 'none'; // Sembunyikan iklan utama
            document.getElementById('comicReaderPage').style.display = 'block';
            
            const readerTitle = document.getElementById('readerTitle');
            const readerDesc = document.getElementById('readerDesc');
            const readerMeta = document.getElementById('readerMeta');
            const comicDisplay = document.getElementById('comicDisplay');
            
            readerTitle.textContent = comic.title;
            readerDesc.textContent = comic.description;
            readerMeta.innerHTML = `üëÅÔ∏è ${comic.reads || 0} dibaca ‚Ä¢ üìÖ ${new Date(comic.uploaded).toLocaleDateString('id-ID')}`;
            comicDisplay.innerHTML = `<p>${comic.description.replace(/\n/g, '<br>')}</p>`; // Menampilkan cerita sebagai teks

            // Track baca
            trackComicRead(index);
        }

        function showMainPage() {
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('mainPageAds').style.display = 'block'; // Tampilkan iklan utama lagi
            document.getElementById('comicReaderPage').style.display = 'none';
            loadComics();
        }

        function trackComicRead(index) {
            const comics = DB.getComics();
            if (comics[index]) {
                comics[index].reads = (comics[index].reads || 0) + 1;
                DB.saveComics(comics);
            }
            const stats = DB.getStats();
            stats.totalReads = (stats.totalReads || 0) + 1;
            DB.updateStats(stats);
            updateStatsDisplay();
        }

        // ADMIN FUNCTIONS
        const ADMIN_EMAIL = 'yuanqingwen31@gmail.com';
        const ADMIN_PASS = 'Msgfy678';

        function openAdminLogin() {
            document.getElementById('loginModal').style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function loginAdmin(e) {
            e.preventDefault();
            const email = document.getElementById('adminEmail').value;
            const pass = document.getElementById('adminPass').value;

            if (email === ADMIN_EMAIL && pass === ADMIN_PASS) {
                DB.loginAdmin();
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('mainContent').style.display = 'none';
                document.getElementById('mainPageAds').style.display = 'none'; // Sembunyikan iklan utama saat di admin panel
                document.getElementById('adminPanel').style.display = 'block';
                loadAdminComics();
                updateStatsDisplay();
            } else {
                alert('‚ùå Email atau password salah!');
            }
        }

        function showAdminSection(section) {
            document.querySelectorAll('.admin-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.admin-nav button').forEach(b => b.classList.remove('active'));
            document.getElementById(section).classList.add('active');
            // 'this' refers to the button clicked, 'event.target' also works
            if (event && event.target) {
                event.target.classList.add('active');
            } else { // Fallback for direct calls without event
                const buttons = document.querySelectorAll('.admin-nav button');
                buttons.forEach(button => {
                    if (button.textContent.toLowerCase().includes(section.replace('Comic', '').toLowerCase())) {
                        button.classList.add('active');
                    }
                });
            }
        }

        function logoutAdmin() {
            DB.logoutAdmin();
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('mainContent').style.display = 'block';
            showMainPage();
        }

        function updateStatsDisplay() {
            const stats = DB.getStats();
            document.getElementById('totalReads').textContent = stats.totalReads || 0;
            document.getElementById('totalComics').textContent = DB.getComics().length;
            document.getElementById('totalVisitors').textContent = stats.totalVisitors || 0;
            document.getElementById('adImpressions').textContent = stats.adImpressions || 0;
        }

        // UPLOAD KOMIK DENGAN SAMPUL
        function uploadComic(e) {
            e.preventDefault();
            const title = document.getElementById('comicTitle').value;
            const description = document.getElementById('comicStory').value;
            const coverFile = document.getElementById('comicCoverFile').files[0];

            if (!coverFile) {
                alert('Pilih file gambar untuk sampul komik!');
                return;
            }

            const progress = document.getElementById('uploadProgress');
            const form = e.target;
            
            progress.style.display = 'block';
            form.style.display = 'none';

            // Baca file gambar sebagai Data URL
            const reader = new FileReader();
            reader.onload = function(event) {
                const coverDataUrl = event.target.result; // Data URL dari gambar

                setTimeout(() => {
                    const comics = DB.getComics();
                    const comicData = {
                        id: Date.now(),
                        title,
                        description,
                        coverDataUrl, // Simpan Data URL gambar sampul
                        uploaded: new Date().toISOString(),
                        reads: 0
                    };
                    comics.unshift(comicData);
                    DB.saveComics(comics);
                    
                    const stats = DB.getStats();
                    stats.totalComics = comics.length;
                    DB.updateStats(stats);

                    form.reset();
                    form.style.display = 'block';
                    progress.style.display = 'none';

                    loadComics();
                    loadAdminComics();
                    updateStatsDisplay();
                    
                    alert('‚úÖ Komik berhasil diupload dengan sampul otomatis!');
                }, 3500);
            };
            reader.readAsDataURL(coverFile); // Mulai membaca file gambar
        }

        function loadAdminComics() {
            const comics = DB.getComics();
            const container = document.getElementById('adminComicList');
            container.innerHTML = '';

            if (comics.length === 0) {
                container.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 3rem;">Belum ada komik yang diupload</p>';
                return;
            }

            comics.forEach(comic => {
                const item = document.createElement('div');
                item.className = 'comic-item';
                item.innerHTML = `
                    <div>
                        <strong style="color: var(--text);">${comic.title}</strong><br>
                        <small style="color: var(--text-muted);">${comic.description.substring(0, 100)}${comic.description.length > 100 ? '...' : ''}</small><br>
                        <small style="color: var(--accent);">üëÅÔ∏è ${comic.reads || 0} dibaca | üìÖ ${new Date(comic.uploaded).toLocaleDateString('id-ID')}</small>
                    </div>
                    <button onclick="deleteComic(${comic.id})" style="background: linear-gradient(45deg, #ef4444, #dc2626); color: white; border: none; padding: 0.8rem 1.5rem; border-radius: 12px; cursor: pointer; font-weight: 600;">üóëÔ∏è Hapus</button>
                `;
                container.appendChild(item);
            });
        }

        function deleteComic(id) {
            if (confirm('Hapus komik ini?')) {
                let comics = DB.getComics();
                comics = comics.filter(c => c.id !== id);
                DB.saveComics(comics);
                loadComics();
                loadAdminComics();
                updateStatsDisplay();
            }
        }

        // CLOSE MODALS & TRACK ADS
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        };

        setInterval(() => {
            const stats = DB.getStats();
            stats.adImpressions = (stats.adImpressions || 0) + 1;
            DB.updateStats(stats);
            updateStatsDisplay();
        }, 8000); // Track ad impressions every 8 seconds
    </script>
</body>
</html>

